---
title: "Explore_Yaa"
author: "Yaa Klu"
date: "11/30/2018"
output: html_document
---

```{r exp_yaa_lib}
library(tidyverse)
```


```{r exp_yaa_data}
felony_crime = readRDS(file = "datasets/all_sex_drug_weapon_zip_2017.rds")

overall_felony = readRDS(file = "./datasets/nyc_felony_crimes.rds")

complete_data = merge(overall_felony, felony_crime, by = "cmplnt_num")
```


Removing NAs

Removing missing variables
```{r}
clean_data = complete_data %>% 
  janitor::clean_names(dat = .) %>% 
  filter(!is.na(susp_race)) %>%
  filter(!is.na(susp_sex)) %>%
  filter(!is.na(susp_age_group))
```



More NAs removed. clean data

```{r}
clean_complete = clean_data %>%
  janitor::clean_names(dat = .) %>%
  filter(!is.na(vic_sex_x)) %>%
  filter(!is.na(vic_race_x)) %>%
  filter(!is.na(vic_age_group))
```


top 10 crimes in all 3 crime groups under felony 

```{r final_project_highest}
clean_complete %>%
  distinct(pd_desc_x) %>%
  count()

clean_complete %>%
  group_by(pd_desc_x, pd_cd_x, crime_group) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(10, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```


Break down data tables – Top 3 or 5 for each category (sex, weapons, drugs) and cross-tab with suspect’s age/race/gender or victim’s age/race/gender
 
 
number of crimes in 3 crime groups

```{r}
clean_complete %>%
  group_by(crime_group) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  #top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable()
```


 top 5 drug related crimes by suspect race
```{r}
clean_complete %>%
  filter(crime_group == "Drug-Related") %>%
  group_by(pd_desc_x, susp_race) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```

top 5 drug related crimes by suspect's age
```{r}
clean_complete %>%
  filter(crime_group == "Drug-Related") %>%
  group_by(pd_desc_x, susp_age_group) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```



top 5 drug related crimes by suspect's sex
```{r}
clean_complete %>%
  filter(crime_group == "Drug-Related") %>%
  group_by(pd_desc_x, susp_sex) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```


top 5 weapon-related crimes by suspect's race

```{r}
clean_complete %>%
  filter(crime_group == "Weapon-Related") %>%
  group_by(pd_desc_x, susp_race) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```


top 5 weapon-related crimes by suspect's age

```{r}
clean_complete %>%
  filter(crime_group == "Weapon-Related") %>%
  group_by(pd_desc_x, susp_age_group) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```


top 5 weapon-related crimes by suspect's sex

```{r}
clean_complete %>%
  filter(crime_group == "Weapon-Related") %>%
  group_by(pd_desc_x, susp_sex) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```


top 5 sex-related crimes by suspects's race

```{r}
clean_complete %>%
  filter(crime_group == "Sex-Related") %>%
  group_by(pd_desc_x, susp_race) %>%
  group_by(pd_desc_x, susp_age_group) %>%
  group_by(pd_desc_x, susp_sex) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(5, number) %>%
  arrange(desc(number)) %>%
  knitr::kable() 
```




