---
title: "Final_project"
author: "Yaa Klu"
date: "11/17/2018"
output: github_document
---

```{r}
crime_nyc = readRDS(file = "datasets/nyc_felony_misdemeanor.rds")
```
 
```{r}
library(tidyverse)
```

**Looking at crime description by age and sex of offenders and victims**

Removing missing variables
```{r}
com_crime_nyc = crime_nyc %>% 
  janitor::clean_names(dat = .) %>% 
  filter(!is.na(susp_sex)) %>%
  filter(!is.na(susp_age_group)) %>%
  filter(!is.na(vic_sex)) %>%
  filter(!is.na(vic_age_group))
```



Highest number of crimes (top 10)
```{r}
com_crime_nyc %>%
  distinct(pd_desc) %>%
  count()

com_crime_nyc %>%
  group_by(pd_desc, susp_age_group) %>%
  summarise(number = n()) %>%
  ungroup() %>%
  top_n(10, number) %>%
  arrange(desc(number)) %>%
  knitr::kable()

```


```{r}
com_crime_nyc %>%
  group_by(pd_desc, susp_age_group) %>%
  summarise(mean = mean(pd_desc)) %>%
  spread(key = susp_age_group, value = mean) %>% 
  ggplot(aes(x = susp_age_group, y = mean)) + 
  geom_col()


```

