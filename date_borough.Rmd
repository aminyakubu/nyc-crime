---
title: "date_and_borough"
author: "Jacky Choi"
date: "November 18, 2018"
output: html_document
---

This is one of the exploratory analyses for our P8105 - Data Science group project. In this exploratory analysis, we attempt to look at whether the length of time of the reported event differs by borough.

First, I load the tidyverse and patchwork package.
```{r date_borough_setup, echo = FALSE}
library(tidyverse)
devtools::install_github("thomasp85/patchwork")
library(patchwork)
```


Next, I read in the CSV file and tidy it up. I limit the data by randomly sampling 1,000 observations from the data frame.
```{r date_borough_tidy_crime_data}
crime_df = readRDS(file = "datasets/nyc_felony_crimes.rds")

crime_data = crime_df %>% 
  janitor::clean_names() %>%
  sample_n(1000) %>% 
  mutate(time_diff = (difftime(cmplnt_to_dt, cmplnt_fr_dt))) %>% 
  mutate(time_diff2 = (as.numeric(cmplnt_to_dt - cmplnt_fr_dt, units = "days", na.rm = TRUE))) %>% 
  select(cmplnt_fr_dt, cmplnt_to_dt, law_cat_cd, time_diff, time_diff2, boro_nm)

head(crime_data)
```


I can look at the data in a table to examine general trends and get a feel of my data.
```{r date_borough_crime_data_table}
crime_table = 
  crime_data %>% 
  knitr::kable(digits = 2)

head(crime_table, 12)
```

I can also look at whether the length of time for the reported event/crime differs by borough visually.
```{r date_borough_length_of_time_of_reported_event}
crime_data2 <- crime_data[complete.cases(crime_data),]

crime_graph2 = 
  crime_data2 %>% 
  group_by(boro_nm, law_cat_cd) %>% 
  ggplot(aes(x = boro_nm, y = time_diff2, color = law_cat_cd)) + 
  geom_point() +
    labs(
    title = "Spread of Times of Reported Event, By Borough",
    x = "Borough",
    y = "Length of Reported Event",
    caption = "Data from the crime_data file"
    ) +
  geom_smooth(se = FALSE) +
  theme(legend.position = "bottom")

crime_graph2
```
From the graph above, we can see a couple of things. First, there are, numerically speaking, fewer reported events in Staten Island. Secondly, the spread of the reported events seems to be slightly larger in the Bronx than in other boroughs. Lastly, although the spread among Brooklyn, Manhattan, and Queens is approximately the same, Queens has more outliers.
